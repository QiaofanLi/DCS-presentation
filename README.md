# DCSç¬¬äºŒç»„-Presentation
![MasterHead](pic/banner(2).png)
[![Typing SVG](https://readme-typing-svg.herokuapp.com?font=Fira+Code&pause=1000&width=435&lines=%F0%9F%98%8DDCS%E7%AC%AC%E4%BA%8C%E7%BB%84%E5%85%A8%E4%BD%93%E6%88%90%E5%91%98%E7%A5%9D%E6%82%A8%E8%82%A0%E9%81%93%E5%81%A5%E5%BA%B7%EF%BC%8C%E6%AF%8F%E5%A4%A9%E5%BC%80%E5%BF%83~)](https://git.io/typing-svg)


ç»„é•¿ï¼šæä¹”å‡¡

ç»„å‘˜ï¼šäºå­å–§ã€å‘¨é©°ã€è¾¾åœ£æ–‡

# Contents
- [ğŸŒˆå‚è€ƒè®ºæ–‡ç½‘å€](#å‚è€ƒè®ºæ–‡ç½‘å€)
	- [è¾¾åœ£æ–‡éƒ¨åˆ†](#è¾¾åœ£æ–‡éƒ¨åˆ†)
	- [æä¹”å‡¡éƒ¨åˆ†](#æä¹”å‡¡éƒ¨åˆ†)
	- [å‘¨é©°éƒ¨åˆ†](#å‘¨é©°éƒ¨åˆ†)
	- [äºå­å–§éƒ¨åˆ†](#äºå­å–§éƒ¨åˆ†)

- [ğŸŒˆå®åŸºå› ç»„ç‰©ç§æ¯”å¯¹æµç¨‹-è¯¦è§£&code](#æµç¨‹è¯¦è§£)

- [ğŸŒˆå¸¸ç”¨ç½‘ç«™&å…¬ä¼—å·æ¨è](#å¸¸ç”¨ç½‘ç«™-å¾®ä¿¡å…¬ä¼—å·æ¨è)
	- [å¸¸ç”¨ç½‘ç«™](#ç½‘ç«™)
	- [å…¬ä¼—å·](#å…¬ä¼—å·)

# ğŸŒˆå‚è€ƒè®ºæ–‡ç½‘å€
## è¾¾åœ£æ–‡éƒ¨åˆ†
1.äººç±»åŸºå› ç»„è®¡åˆ’ï¼ˆHGPï¼‰ï¼šhttps://www.nature.com/nature/volumes/409/issues/6822

2.äººç±»å¾®ç”Ÿç‰©ç»„è®¡åˆ’ï¼ˆHMPï¼‰ï¼šhttps://www.hmpdacc.org/

3.å¾®ç”Ÿç‰©ç»„ï¼šhttps://doi.org/10.1016/j.cell.2018.02.044

4.äººä½“è‚ é“å®åŸºå› ç»„è®¡åˆ’ï¼ˆMetaHITï¼‰ï¼šhttp://www.metahit.eu

## æä¹”å‡¡éƒ¨åˆ†
1.äººç±»å¾®ç”Ÿç‰©ç»„ç ”ç©¶æŒ‡å—ï¼šhttps://doi.org/10.1097/CM9.0000000000000871

2.å­Ÿå¾·å°”éšæœºåŒ–åˆ†æéªŒè¯å› æœå…³ç³»ï¼šhttps://doi.org/10.1038/s41588-021-00968-y

3.è‚ é“å¾®ç”Ÿç‰©ç»„çš„é•¿æœŸé—ä¼ ç¨³å®šæ€§å’Œä¸ªä½“ç‰¹å¼‚æ€§ï¼šhttps://doi.org/10.1016/j.cell.2021.03.024

4.è‚ é“å¾®ç”Ÿç‰©ç»„ä¸­çš„ç»†èŒ SNP ä¸å®¿ä¸»çš„ BMI ç›¸å…³ï¼šhttps://doi.org/10.1038/s41591-023-02599-8

5.å®åŸºå› ç»„åŸºç¡€æµç¨‹ï¼šhttps://mp.weixin.qq.com/s/xHe1FHLm3n0Vkxz0nNbXvQ

6.å¾®ç”Ÿç‰©-ç–¾ç—…å…³è”ç ”ç©¶èŒƒå¼ï¼ˆMWASï¼‰ï¼š
https://doi.org/10.1038/nature11450
https://doi.org/10.1038/nrmicro.2016.83

7.ç‰©ç§-ä»£è°¢å…³è”åˆ†æï¼š
https://doi.org/10.1038/s41591-019-0458-7
https://doi.org/10.1038/s41586-022-04567-7

8.SV&SNP~ä»£è°¢å…³è”åˆ†æç­–ç•¥ï¼š
https://10.1016/j.cell.2021.03.024
https://10.103a8/s41591-023-02599-8

## å‘¨é©°éƒ¨åˆ†
1.å®åŸºå› ç»„çš„åº”ç”¨.ä¸´åºŠï¼š
https://genome.cshlp.org/content/29/5/831

https://www.pnas.org/doi/full/10.1073/pnas.1809700115

2.å®åŸºå› ç»„çš„åº”ç”¨.ç¯å¢ƒï¼š
https://www.nature.com/articles/s41586-024-07891-2

## äºå­å–§éƒ¨åˆ†
1.é¼»è…”å¾®ç”Ÿç‰©å…³è”ï¼šhttps://www.nature.com/articles/s42003-024-05822-5

2.å£è…”å¾®ç”Ÿç‰©å…³è”ï¼šhttps://www.nature.com/articles/s41421-021-00356-0

3.çš®è‚¤å¾®ç”Ÿç‰©å…³è”ï¼šhttps://onlinelibrary.wiley.com/doi/10.1002/advs.202300050

4.é˜´é“å¾®ç”Ÿç‰©å…³è”ï¼šhttps://www.nature.com/articles/s41467-024-52102-1

5.è‚ é“å¾®ç”Ÿç‰©å…³è”ï¼šhttps://www.nature.com/articles/s41588-021-00968-y

6.è‚ é“å¾®ç”Ÿç‰©ä¸ä»£è°¢/è¡¨å‹ç›¸å…³ï¼šhttps://www.nature.com/articles/s41467-017-00900-1

7.æè¿°æ€§/å…³è”æ€§â†’å› æœæ€§/æœºåˆ¶æ€§ï¼šhttps://www.nature.com/articles/s41588-021-00968-y

8.æ·±å…¥åˆ°åŸºå› å±‚é¢ç ”ç©¶ï¼šhttps://www.nature.com/articles/s41591-023-02599-8

# ğŸŒˆæµç¨‹è¯¦è§£
æ ·æœ¬ğŸ‘‰æå–DNAğŸ‘‰å®åŸºå› ç»„æµ‹åºğŸ‘‰æ•°æ®é¢„å¤„ç†ğŸ‘‰è´¨æ§ã€æ¯”å¯¹ï¼ˆåŸºäºreadsï¼‰ğŸ‘‰ç»„è£…/æ‹¼æ¥åˆ†æğŸ‘‰ç‰©ç§ç»„æˆã€åŠŸèƒ½åˆ†æã€‚

å¼ºçƒˆå»ºè®®å‚è€ƒæˆ‘ä»¬ç»„å¼€å‘çš„metapiï¼ŒåŒ…å«äº†å®åŸºå› ç»„çš„æ‰€æœ‰å¸¸è§„æµç¨‹çš„è½¯ä»¶ï¼Œæ— éœ€ä¸€ä¸ªä¸€ä¸ªå®‰è£…ï¼šhttps://github.com/ohmeta/metapi

ä¸‹æ–‡æµç¨‹åŸºäºæˆ‘ä»¬ç»„å¼€å‘çš„metaprofæµç¨‹ï¼šhttps://github.com/weiting-liang/metaprof

è½¯ä»¶æ”¯æŒï¼š

fastpï¼šhttps://github.com/OpenGene/fastp

bowtie2ï¼š: https://github.com/BenLangmead/bowtie2

MetaPhlAn4ï¼šhttps://github.com/biobakery/MetaPhlAn
## environment
  - biopython>=1.76
  - bowtie2>=2.3.5.1
  - fastp>=0.20.1
  - metaphlan>=4.1.0
  - numpy>=1.18.4
  - pandas>=1.0.3
  - pigz>=2.3.4
  - samtools>=1.9
  - seqkit>=0.12.1
  - snakemake>=5.14.0
  - kraken2>=2.1.1
  - bracken>=2.5

## install

```
git clone https://github.com/weiting-liang/metaprof.git

cd metaprof
conda env create -n metaprof -f ./rules/env.yaml
conda activate metaprof
```


#database prepare  
human reference
https://github.com/marbl/CHM13
```
mkdir /path/database
cd database && mkdir humanhost && cd humanhost 
wget https://s3-us-west-2.amazonaws.com/human-pangenomics/T2T/CHM13/assemblies/analysis_set/chm13v2.0.fa.gz
gzip chm13v2.0.fa.gz -d
mkdir bowtie2_index && cd bowtie2_index
bowtie2-build ../chm13v2.0.fa chm13v2
```

metaphlan3
```
cd /path/database
mkdir metaphlan && cd metaphlan
metaphlan --install --index mpa_vOct22_CHOCOPhlAnSGB_202212 --bowtie2db metaphlan_database
```

kraken2
```
cd /path/database
mkdir kraken2 && cd kraken_pub
wget https://genome-idx.s3.amazonaws.com/kraken/k2_standard_20210517.tar.gz
tar -xzvf k2_standard_20210517.tar.gz -C ./k2_standard_20210517
```

## run
- change the `samples.txt` to adapt to your data: separator should be "\t": id^Ifq1^Ifq2$
- custom the `config.yaml` database's path and parameters

```
#dry run
snakemake --snakefile rules/profile.smk -n
#test
snakemake --snakefile rules/profile.smk --core 16 2> smk.log &
#cluster: custom the cluster.yaml
nohup sh snakemake.sh &
```

## output

2.results/  
  filter_summary.txt  
  metaphlan4.profile.merge.txt 
  bracken.merged.abundance.profile.*.tsv  

#assay:  
1.assay  
  01.trimming/  
  02.rmhost/  
  03.profile/  
  benchmarks/   #check the cpu's time and max_vms to optimize the cluster's parameters  
  cluster_logs/   
  logs/         #find programs' errors  


## references
https://github.com/ohmeta/metapi/blob/master/metapi/Snakefile

https://github.com/liu930724/meta_profile

## pipeline WDL
è§æ–‡ä»¶[README1](metaphlan4_Pu_1.3.0.wdl)

```
å¦‚æœ‰éœ€è¦ä½¿ç”¨ï¼Œè¯·è”ç³»æˆ‘ï¼Œæˆ‘ä¼šå‘ä½ æä¾›docker
```
# ğŸŒˆå¸¸ç”¨ç½‘ç«™-å¾®ä¿¡å…¬ä¼—å·æ¨è
## ç½‘ç«™
ç»„å­¦åŸå§‹æ•°æ®å½’æ¡£ï¼ˆGSAï¼‰ï¼šhttp://gsa.big.ac.cn

Qiitaï¼šhttps://qiita.ucsd.edu

MGnifyï¼šhttps://www.ebi.ac.uk/metagenomics

gcMetaï¼šhttps://gcmeta.wdcm.org

R Markdownï¼šhttps://rmarkdown.rstudio.com

R Graph Galleryï¼šhttps://www.r-graph.gallery.com

SangerBoxç»˜å›¾ç½‘ç«™ï¼šhttp://sangerbox.com/home.html

HiPlotç»˜å›¾ç½‘ç«™ï¼šhttps://hiplot.cn/basic

BICç»˜å›¾ç½‘ç«™ï¼šhttps://www.bic.ac.cn/BIC/#/


## å…¬ä¼—å·

ç”Ÿä¿¡ç›Šç«™    |    å®åŸºå› ç»„    |    iNature    |    ç”Ÿä¿¡æŠ€èƒ½æ ‘    |    ç”Ÿä¿¡é€š
<p float="left">
  <img src="pic/ç”Ÿä¿¡ç›Šç«™.png" width="150" />
  <img src="pic/å®åŸºå› ç»„.png" width="150" /> 
  <img src="pic/iNature.png" width="150" />
  <img src="pic/ç”Ÿä¿¡æŠ€èƒ½æ ‘.png" width="150" />
  <img src="pic/ç”Ÿä¿¡é€š.png" width="150" />
</p>

## ğŸŒˆè‡´è°¢

æ„Ÿè°¢æˆ‘ä»¬æ•¬çˆ±çš„åˆ˜å°æ•è€å¸ˆã€å¼ æ¶›è€å¸ˆã€è‚–äº®è€å¸ˆã€æ¨ç„•æ˜è€å¸ˆã€‚

æ„Ÿè°¢å‘¨é©°ã€è¾¾åœ£æ–‡ã€äºå­å–§åŒå­¦çš„å…±åŒåŠªåŠ›ã€‚

æ„Ÿè°¢æ¢å«å©·å¸ˆå§æä¾›çš„metaprofæµç¨‹ã€‚

ç‰¹åˆ«æ„Ÿè°¢äº²çˆ±çš„äºå­å–§åŒå­¦ï¼ŒMy loveã€‚

2024.10.23
